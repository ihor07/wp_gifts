function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module&&"function"==typeof require?module.exports=e(require("jquery")):e(t.jQuery)}(this,(function(t){"use strict";var e="wcpwVariationForm",i=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.element=e,this.customOptions=i,this.options=t.extend({},i),this.init()};i.prototype.init=function(){return this.$element=t(this.element),this.$reset=this.$element.find('[data-component~="wcpw-product-variations-reset"]'),this.$id=this.$element.find('[data-component~="wcpw-product-variations-variation-id"]'),this.$input=this.$element.find('[data-component~="wcpw-product-variations-item-input"]'),this.$variationItem=this.$element.find('[data-component~="wcpw-product-variations-item"]'),this.$variationItemValue=this.$element.find('[data-component~="wcpw-product-variations-item-value"]'),this.$product=this.$element.closest('[data-component~="wcpw-product"]'),this.$productPrice=this.$product.find('[data-component~="wcpw-product-price"]'),this.$productQuantity=this.$product.find('[data-component~="wcpw-product-quantity"] :input:not([type="button"])'),this.$productDescription=this.$product.find('[data-component~="wcpw-product-description"]'),this.$productAvailability=this.$product.find('[data-component~="wcpw-product-availability"]'),this.$productSku=this.$product.find('[data-component~="wcpw-product-sku"]'),this.$productAddToCart=this.$product.find('[data-component~="wcpw-add-cart-product"]'),this.$productChoose=this.$product.find('[data-component~="wcpw-product-choose"]'),this.$productImage=this.$product.find('[data-component~="wcpw-product-thumbnail-image"]'),this.$productLink=this.$product.find('[data-component~="wcpw-product-thumbnail-link"]'),this.initEventListeners().triggerEvent("launched.variationForm.wcpw",[this])},i.prototype.initEventListeners=function(){var e=this,i=this;return this.$element.unbind("check_variations update_variation_values found_variation change"),this.$element.off(".wc-variation-form"),this.$input.unbind("change"),this.$element.on("check_variations",(function(i,r,a){var n={},o=!0;e.$input.each((function(){var e=t(this);"SELECT"!==e.prop("tagName")||e.val()&&0!==e.val().length||(o=!1),("SELECT"===e.prop("tagName")||e.is(":checked"))&&(n[this.getAttribute("data-name")]=e.val())}));var c=e.findMatchingVariations(e.$element.data("product_variations"),n);if(o){var s=null;for(var d in c)if(c.hasOwnProperty(d)){var p=e.extendObject(n),u=e.extendObject(c[d].attributes);for(var h in u)u.hasOwnProperty(h)&&""===u[h]&&(u[h]=p[h]);if(JSON.stringify(u)===JSON.stringify(p)){s=c[d];break}}s?(e.$id.val(s.variation_id).change(),e.triggerEvent("found_variation",[s])):a||(e.triggerEvent("reset_image"),e.triggerEvent("hide_variation"))}else a||(e.triggerEvent("reset_image"),e.triggerEvent("hide_variation")),r||(e.$productPrice.html(e.$productPrice.data("default")),e.$productDescription.html(e.$productDescription.data("default")),e.$productAvailability.html(e.$productAvailability.data("default")),e.$productSku.html(e.$productSku.data("default")));e.triggerEvent("update_variation_values",[e.extendObject(c),e.extendObject(n)]),e.$productAddToCart.add(e.$productChoose).prop("disabled",!e.$id.val())})),this.$element.on("reset_image",(function(){return e.updateImage(!1)})),this.$element.on("update_variation_values",(function(r,a,n){if(!a||Object.keys(a).length<=0)return e;var o=!0;return e.$variationItem.each((function(){var e=t(this),r=this.getAttribute("data-name"),c=e.find('[data-component~="wcpw-product-variations-item-value"]');for(var s in c.removeClass("active").prop("disabled",!1),a)if(a.hasOwnProperty(s)){var d=i.extendObject(a[s].attributes);for(var p in d)if(d.hasOwnProperty(p)&&p===r){var u=d[p];if(!u){var h=i.extendObject(n),l=i.extendObject(d);for(var m in delete l[p],delete h[p],l)l.hasOwnProperty(m)&&""===l[m]&&(delete l[m],delete h[m]);JSON.stringify(l)===JSON.stringify(h)&&c.addClass("active")}u=(u=(u=t("<div/>").html(u).text()).replace(/'/g,"\\'")).replace(/"/g,'\\"'),c.filter(""!==u?'[value="'.concat(u,'"]'):"*").addClass("active")}}if(c.filter(":not(.active)").prop("disabled",!0),"SELECT"===e.prop("tagName")){var f=e.find("option:selected");if(f.attr("selected")||(o=!1),f.is(":disabled")){var v=e.find("option:not(:disabled)");v.length>0&&setTimeout((function(){return e.val(v.eq(0).attr("value")).trigger("change")}),0)}}else{var g=c.filter(":checked");if(g.attr("checked")||(o=!1),g.is(":disabled")){var $=c.filter(":not(:disabled)");$.length>0&&setTimeout((function(){return $.eq(0).prop("checked",!0).trigger("change")}),0)}}})),e.$reset.attr("hidden",o),e.triggerEvent("woocommerce_update_variation_values"),e})),this.$element.on("found_variation",(function(t,i){var r=!0;return i.price_html&&e.$productPrice.html(i.price_html),i.min_qty&&e.$productQuantity.attr("min",i.min_qty),i.max_qty&&e.$productQuantity.attr("max",i.max_qty),e.$productDescription.html(i.description||i.variation_description||e.$productDescription.data("default")),e.$productAvailability.html(i.availability_html||e.$productAvailability.data("default")),e.$productSku.html(i.sku||e.$productSku.data("default")),i.is_purchasable&&i.is_in_stock&&i.variation_is_visible||(r=!1),e.$productAddToCart.add(e.$productChoose).prop("disabled",!r),e.updateImage(i)})),this.$element.on("reset",(function(){e.$variationItemValue.each((function(){var e="INPUT"===this.tagName;return t(this).prop("disabled",!1).prop(e?"checked":"selected",e?this.defaultChecked:this.defaultSelected)})),e.$reset.attr("hidden",!0),e.triggerEvent("check_variations")})),this.$element.on("change.input.variationForm.wcpw",'[data-component~="wcpw-product-variations-item-input"]',(function(){i.$id.val("").change(),i.triggerEvent("woocommerce_variation_select_change"),i.triggerEvent("check_variations",[this.getAttribute("data-name"),!0]),t().uniform&&t.isFunction(t.uniform.update)&&t.uniform.update()})),this.$element.on("click.reset.variationForm.wcpw",'[data-component~="wcpw-product-variations-reset"]',(function(t){return t.preventDefault(),e.triggerEvent("reset")})),this.triggerEvent("check_variations"),this.triggerEvent("wc_variation_form"),this},i.prototype.triggerEvent=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.$element.trigger(t,e),this},i.prototype.resetAttr=function(t,e){return void 0!==t.attr("data-o_".concat(e))&&t.attr(e,t.attr("data-o_".concat(e))),this},i.prototype.setAttr=function(t,e,i){return void 0===t.attr("data-o_".concat(e))&&t.attr("data-o_".concat(e),t.attr(e)?t.attr(e):""),!1===i?t.removeAttr(e):t.attr(e,i),this},i.prototype.updateImage=function(t){return t&&t.image&&(t.image.src||t.image_src)?(this.setAttr(this.$productImage,"src",t.image_src||t.image.src),this.setAttr(this.$productImage,"srcset",t.image_srcset||t.image.srcset),this.setAttr(this.$productImage,"sizes",t.image_sizes||t.image.sizes),this.setAttr(this.$productImage,"title",t.image_title||t.image.title),this.setAttr(this.$productImage,"alt",t.image_alt||t.image.alt),this.setAttr(this.$productLink,"href",t.image_link||t.image.full_src)):(this.resetAttr(this.$productImage,"src"),this.resetAttr(this.$productImage,"srcset"),this.resetAttr(this.$productImage,"sizes"),this.resetAttr(this.$productImage,"alt"),this.resetAttr(this.$productLink,"href")),this},i.prototype.findMatchingVariations=function(t,e){var i=[],r={};for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];for(var o in e)if(e.hasOwnProperty(o)){var c=this.extendObject(n.attributes),s=this.extendObject(e);for(var d in delete c[o],delete s[o],c)c.hasOwnProperty(d)&&""===c[d]&&(delete c[d],delete s[d]);JSON.stringify(c)!==JSON.stringify(s)||r.hasOwnProperty(n.variation_id)||(r[n.variation_id]=n.variation_id,i.push(n))}}return i},i.prototype.extendObject=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.extend.apply(t,[{}].concat(i))},t.fn[e]=function(r){return this.each((function(){t.data(this,e)||t.data(this,e,new i(this,r))}))}}));